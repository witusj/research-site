"0",""
"0","# Simulation 1"
"0",""
"0","tic = time.time()"
"0","sim = np.array([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]) # initial schedule"
"0","iats = fn.transform_schedule_iats(sim, d) # initial inter-arrival times"
"0","iats_d = np.diff(iats)"
"0","N = len(iats) # number of patients"
"0","# T = len(sim) # number of intervals"
"0","ctsm = np.random.choice(cts, size = (nsims * N), p=pct).reshape((nsims, N)) # client types matrix"
"0","stsm = np.random.lognormal(mean = nm, sigma=ns, size=(nsims * N)).reshape(nsims, N) # service times matrix"
"0","nsm = np.random.binomial(n=1, p=1-ns, size = (nsims * N)).reshape(nsims, N) # no-shows matrix"
"0","stsm = stsm * nsm # service times matrix with no-shows"
"0","simreswt = []"
"0","simresln = 0"
"0",""
"0","for i in range(nsims):"
"0","  experiment = fn.simulate_crn(iats, ctsm[i], stsm[i], logs=logs)"
"0","  simreswt.append(experiment[0].mean())"
"0","  ln = max(0, (experiment[1] - d))"
"0","  simresln += ln"
"0","  "
"0","mwt = np.array(simreswt).mean()"
"0","mln = simresln / nsims"
"0","loss = loss = 0.5 * mwt + 0.5 * mln"
"0","toc = time.time()"
"0","print(toc - tic)"
"1","4.0964882373809814
"
"0","# plots"
"0",""
"0","fig1, (axs1, axs2) = plt.subplots(2, sharey=True, tight_layout=True)"
"0","axs1.plot(iats, label=""iats"")"
"1","[<matplotlib.lines.Line2D object at 0x1b16e5c60>]
"
"0","axs1.set_title(f'iats: {iats}')"
"1","Text(0.5, 1.0, 'iats: [ 0 15 15 15 15 15 15 15 15 15 15 15]')
"
"0","axs2.plot(iats_d, label=""iats_d"")"
"1","[<matplotlib.lines.Line2D object at 0x1b16e6050>]
"
"0","axs2.set_title(f'iats_d: {iats_d}')"
"1","Text(0.5, 1.0, 'iats_d: [15  0  0  0  0  0  0  0  0  0  0]')
"
"0","fig2, axs3 = plt.subplots(1, sharey=True, tight_layout=True)"
"0","axs3.hist(simreswt, bins = 300)"
"1","(array([1.2533e+04, 7.3080e+03, 7.1300e+03, 6.8360e+03, 6.2870e+03,
       5.7670e+03, 5.1110e+03, 4.7030e+03, 4.2230e+03, 3.7440e+03,
       3.3600e+03, 2.9800e+03, 2.6840e+03, 2.3480e+03, 2.0550e+03,
       1.8690e+03, 1.6410e+03, 1.5770e+03, 1.3760e+03, 1.2890e+03,
       1.1180e+03, 1.0970e+03, 9.4200e+02, 8.7700e+02, 7.5900e+02,
       7.2900e+02, 6.9800e+02, 6.3100e+02, 5.9400e+02, 4.9400e+02,
       4.4900e+02, 4.8200e+02, 3.8000e+02, 3.5500e+02, 3.2700e+02,
       3.2100e+02, 2.9400e+02, 2.4700e+02, 2.5300e+02, 2.4900e+02,
       1.8100e+02, 2.1600e+02, 1.6600e+02, 1.9000e+02, 1.8800e+02,
       1.5600e+02, 1.4100e+02, 1.5100e+02, 1.2300e+02, 1.2300e+02,
       1.1300e+02, 1.0000e+02, 1.1300e+02, 7.3000e+01, 9.9000e+01,
       8.2000e+01, 7.1000e+01, 6.7000e+01, 6.7000e+01, 5.8000e+01,
       6.5000e+01, 5.7000e+01, 6.8000e+01, 5.5000e+01, 5.5000e+01,
       4.9000e+01, 3.9000e+01, 4.6000e+01, 3.1000e+01, 2.6000e+01,
       4.5000e+01, 4.3000e+01, 3.4000e+01, 2.7000e+01, 3.3000e+01,
       3.2000e+01, 2.4000e+01, 2.8000e+01, 2.5000e+01, 3.1000e+01,
       2.9000e+01, 2.4000e+01, 3.6000e+01, 2.8000e+01, 1.3000e+01,
       1.8000e+01, 1.7000e+01, 1.7000e+01, 1.6000e+01, 2.0000e+01,
       1.5000e+01, 1.2000e+01, 1.1000e+01, 1.6000e+01, 8.0000e+00,
       1.1000e+01, 1.6000e+01, 7.0000e+00, 1.1000e+01, 1.3000e+01,
       1.3000e+01, 9.0000e+00, 6.0000e+00, 1.3000e+01, 5.0000e+00,
       1.1000e+01, 4.0000e+00, 1.1000e+01, 1.4000e+01, 4.0000e+00,
       7.0000e+00, 1.0000e+01, 3.0000e+00, 2.0000e+00, 6.0000e+00,
       9.0000e+00, 5.0000e+00, 8.0000e+00, 4.0000e+00, 1.0000e+00,
       1.0000e+00, 4.0000e+00, 5.0000e+00, 7.0000e+00, 7.0000e+00,
       2.0000e+00, 5.0000e+00, 1.0000e+00, 2.0000e+00, 3.0000e+00,
       2.0000e+00, 2.0000e+00, 6.0000e+00, 3.0000e+00, 3.0000e+00,
       2.0000e+00, 2.0000e+00, 3.0000e+00, 1.0000e+00, 1.0000e+00,
       3.0000e+00, 1.0000e+00, 2.0000e+00, 2.0000e+00, 2.0000e+00,
       3.0000e+00, 1.0000e+00, 1.0000e+00, 1.0000e+00, 2.0000e+00,
       3.0000e+00, 1.0000e+00, 1.0000e+00, 0.0000e+00, 1.0000e+00,
       1.0000e+00, 0.0000e+00, 4.0000e+00, 1.0000e+00, 0.0000e+00,
       0.0000e+00, 0.0000e+00, 1.0000e+00, 2.0000e+00, 0.0000e+00,
       0.0000e+00, 1.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00,
       0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00, 2.0000e+00,
       0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00,
       1.0000e+00, 0.0000e+00, 0.0000e+00, 1.0000e+00, 0.0000e+00,
       1.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00,
       0.0000e+00, 1.0000e+00, 0.0000e+00, 1.0000e+00, 0.0000e+00,
       0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00,
       0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00,
       0.0000e+00, 0.0000e+00, 1.0000e+00, 0.0000e+00, 0.0000e+00,
       0.0000e+00, 0.0000e+00, 0.0000e+00, 2.0000e+00, 0.0000e+00,
       0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00,
       0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00,
       0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00,
       0.0000e+00, 0.0000e+00, 1.0000e+00, 1.0000e+00, 0.0000e+00,
       0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00,
       0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00,
       0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00,
       0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00,
       0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00,
       0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00,
       0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00,
       0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00,
       0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00,
       0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00,
       0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00,
       0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00,
       0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00, 1.0000e+00]), array([ 0.        ,  0.14737788,  0.29475576,  0.44213363,  0.58951151,
        0.73688939,  0.88426727,  1.03164515,  1.17902302,  1.3264009 ,
        1.47377878,  1.62115666,  1.76853454,  1.91591242,  2.06329029,
        2.21066817,  2.35804605,  2.50542393,  2.65280181,  2.80017968,
        2.94755756,  3.09493544,  3.24231332,  3.3896912 ,  3.53706907,
        3.68444695,  3.83182483,  3.97920271,  4.12658059,  4.27395847,
        4.42133634,  4.56871422,  4.7160921 ,  4.86346998,  5.01084786,
        5.15822573,  5.30560361,  5.45298149,  5.60035937,  5.74773725,
        5.89511512,  6.042493  ,  6.18987088,  6.33724876,  6.48462664,
        6.63200452,  6.77938239,  6.92676027,  7.07413815,  7.22151603,
        7.36889391,  7.51627178,  7.66364966,  7.81102754,  7.95840542,
        8.1057833 ,  8.25316117,  8.40053905,  8.54791693,  8.69529481,
        8.84267269,  8.99005057,  9.13742844,  9.28480632,  9.4321842 ,
        9.57956208,  9.72693996,  9.87431783, 10.02169571, 10.16907359,
       10.31645147, 10.46382935, 10.61120722, 10.7585851 , 10.90596298,
       11.05334086, 11.20071874, 11.34809662, 11.49547449, 11.64285237,
       11.79023025, 11.93760813, 12.08498601, 12.23236388, 12.37974176,
       12.52711964, 12.67449752, 12.8218754 , 12.96925327, 13.11663115,
       13.26400903, 13.41138691, 13.55876479, 13.70614267, 13.85352054,
       14.00089842, 14.1482763 , 14.29565418, 14.44303206, 14.59040993,
       14.73778781, 14.88516569, 15.03254357, 15.17992145, 15.32729932,
       15.4746772 , 15.62205508, 15.76943296, 15.91681084, 16.06418872,
       16.21156659, 16.35894447, 16.50632235, 16.65370023, 16.80107811,
       16.94845598, 17.09583386, 17.24321174, 17.39058962, 17.5379675 ,
       17.68534537, 17.83272325, 17.98010113, 18.12747901, 18.27485689,
       18.42223477, 18.56961264, 18.71699052, 18.8643684 , 19.01174628,
       19.15912416, 19.30650203, 19.45387991, 19.60125779, 19.74863567,
       19.89601355, 20.04339142, 20.1907693 , 20.33814718, 20.48552506,
       20.63290294, 20.78028082, 20.92765869, 21.07503657, 21.22241445,
       21.36979233, 21.51717021, 21.66454808, 21.81192596, 21.95930384,
       22.10668172, 22.2540596 , 22.40143747, 22.54881535, 22.69619323,
       22.84357111, 22.99094899, 23.13832687, 23.28570474, 23.43308262,
       23.5804605 , 23.72783838, 23.87521626, 24.02259413, 24.16997201,
       24.31734989, 24.46472777, 24.61210565, 24.75948352, 24.9068614 ,
       25.05423928, 25.20161716, 25.34899504, 25.49637292, 25.64375079,
       25.79112867, 25.93850655, 26.08588443, 26.23326231, 26.38064018,
       26.52801806, 26.67539594, 26.82277382, 26.9701517 , 27.11752957,
       27.26490745, 27.41228533, 27.55966321, 27.70704109, 27.85441897,
       28.00179684, 28.14917472, 28.2965526 , 28.44393048, 28.59130836,
       28.73868623, 28.88606411, 29.03344199, 29.18081987, 29.32819775,
       29.47557562, 29.6229535 , 29.77033138, 29.91770926, 30.06508714,
       30.21246502, 30.35984289, 30.50722077, 30.65459865, 30.80197653,
       30.94935441, 31.09673228, 31.24411016, 31.39148804, 31.53886592,
       31.6862438 , 31.83362167, 31.98099955, 32.12837743, 32.27575531,
       32.42313319, 32.57051106, 32.71788894, 32.86526682, 33.0126447 ,
       33.16002258, 33.30740046, 33.45477833, 33.60215621, 33.74953409,
       33.89691197, 34.04428985, 34.19166772, 34.3390456 , 34.48642348,
       34.63380136, 34.78117924, 34.92855711, 35.07593499, 35.22331287,
       35.37069075, 35.51806863, 35.66544651, 35.81282438, 35.96020226,
       36.10758014, 36.25495802, 36.4023359 , 36.54971377, 36.69709165,
       36.84446953, 36.99184741, 37.13922529, 37.28660316, 37.43398104,
       37.58135892, 37.7287368 , 37.87611468, 38.02349256, 38.17087043,
       38.31824831, 38.46562619, 38.61300407, 38.76038195, 38.90775982,
       39.0551377 , 39.20251558, 39.34989346, 39.49727134, 39.64464921,
       39.79202709, 39.93940497, 40.08678285, 40.23416073, 40.38153861,
       40.52891648, 40.67629436, 40.82367224, 40.97105012, 41.118428  ,
       41.26580587, 41.41318375, 41.56056163, 41.70793951, 41.85531739,
       42.00269526, 42.15007314, 42.29745102, 42.4448289 , 42.59220678,
       42.73958466, 42.88696253, 43.03434041, 43.18171829, 43.32909617,
       43.47647405, 43.62385192, 43.7712298 , 43.91860768, 44.06598556,
       44.21336344]), <BarContainer object of 300 artists>)
"
"0","axs3.set_title(f'schedule: {sim}, mwt: {mwt}, mln: {mln}, loss: {loss}')"
"1","Text(0.5, 1.0, 'schedule: [1 1 1 1 1 1 1 1 1 1 1 1], mwt: 1.61872679689171, mln: 1.974766956156535, loss: 1.7967468765241226')
"
